import pandas as pd
import numpy as np
import tensorflow as tf

import matplotlib.pyplot as plt
import seaborn as sns
import random as rn
from sklearn.preprocessing import MinMaxScaler
import pickle
from sklearn.model_selection import train_test_split
from datetime import datetime

from Autoencoder.train_autoencoder.autoencoder import autoenocder_model, load_data, save_data, plot_auto_train, train_autoencoder

THRESHOLD = 1000


def mad_score(points):
    m = np.median(points)
    ad = np.abs(points - m)
    mad = np.median(ad)

    if mad != 0 and not np.isnan(mad):
        return 0.6745 * ad / mad
    else:
        return 0.6745 * ad / 0.0001


def calculate_z_score(THRESHOLD, mse):
    z_scores = mad_score(mse)
    # outliers = np.where(z_scores > THRESHOLD)
    outliers = z_scores > THRESHOLD

    # if there is y_train variable
    if 'y_train' in globals():
        same_count = 0

        # compare outliers with y_train and get count of same and different
        for i in range(len(outliers)):
            if outliers[i] == y_train[i]:
                same_count += 1

        print(f"THRESHOLD: {THRESHOLD}, same_count: {same_count}, different_count: {len(outliers) - same_count}")

    return outliers


if __name__ == '__main__':
    ########################### PREPARE DATASET ##############################
    # data_path = "D:\Projects\IntrusionDetection\old\create_dataset\class_final.csv"
    # X_train, y_train, X_validate, y_validate, X_test, y_test = process_dataset(data_path)
    #
    # save_data(X_train, y_train, X_validate, y_validate, X_test, y_test)
    X_train, y_train, X_validate, y_validate, X_test, y_test = load_data()

    ########################### AUTO ENCODER ##############################
    input_dim = X_train.shape[1]
    autoencoder = autoenocder_model(input_dim)

    # load autoencoder weights
    autoencoder.load_weights("autoencoder_best_weights.hdf5")

    # with X_train predict autoencoder
    X_train_pred = autoencoder.predict(X_train)
    # calculate mse
    mse = np.mean(np.power(X_train - X_train_pred, 2), axis=1)

    # for i in range(0, 1000):
    #     THRESHOLD = i
    outliers = calculate_z_score(THRESHOLD, mse)

    print(outliers)

# D:\Projects\IntrusionDetection\venv\Scripts\python.exe D:\Projects\IntrusionDetection\Autoencoder\train_autoencoder\predict_auto.py
# 2023-07-27 17:36:35.632264: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
# To enable the following instructions: SSE SSE2 SSE3 SSE4.1 SSE4.2 AVX AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
# Model: "sequential"
# _________________________________________________________________
#  Layer (type)                Output Shape              Param #
# =================================================================
#  dense (Dense)               (None, 72)                5256
#
#  dense_1 (Dense)             (None, 16)                1168
#
#  dense_2 (Dense)             (None, 8)                 136
#
#  dense_3 (Dense)             (None, 4)                 36
#
#  dense_4 (Dense)             (None, 2)                 10
#
#  dense_5 (Dense)             (None, 4)                 12
#
#  dense_6 (Dense)             (None, 8)                 40
#
#  dense_7 (Dense)             (None, 16)                144
#
#  dense_8 (Dense)             (None, 72)                1224
#
# =================================================================
# Total params: 8026 (31.35 KB)
# Trainable params: 8026 (31.35 KB)
# Non-trainable params: 0 (0.00 Byte)
# _________________________________________________________________
# 35916/35916 [==============================] - 44s 1ms/step
# 2023-07-27 17:37:39.974928: W tensorflow/tsl/framework/cpu_allocator_impl.cc:83] Allocation of 330998976 exceeds 10% of free system memory.
# THRESHOLD: 0, same_count: 0, different_count: 1149302
# THRESHOLD: 1, same_count: 702668, different_count: 446634
# THRESHOLD: 2, same_count: 794914, different_count: 354388
# THRESHOLD: 3, same_count: 849566, different_count: 299736
# THRESHOLD: 4, same_count: 928812, different_count: 220490
# THRESHOLD: 5, same_count: 958932, different_count: 190370
# THRESHOLD: 6, same_count: 980110, different_count: 169192
# THRESHOLD: 7, same_count: 995353, different_count: 153949
# THRESHOLD: 8, same_count: 1008953, different_count: 140349
# THRESHOLD: 9, same_count: 1019662, different_count: 129640
# THRESHOLD: 10, same_count: 1027505, different_count: 121797
# THRESHOLD: 11, same_count: 1039098, different_count: 110204
# THRESHOLD: 12, same_count: 1044182, different_count: 105120
# THRESHOLD: 13, same_count: 1049519, different_count: 99783
# THRESHOLD: 14, same_count: 1052576, different_count: 96726
# THRESHOLD: 15, same_count: 1054869, different_count: 94433
# THRESHOLD: 16, same_count: 1056834, different_count: 92468
# THRESHOLD: 17, same_count: 1059854, different_count: 89448
# THRESHOLD: 18, same_count: 1063354, different_count: 85948
# THRESHOLD: 19, same_count: 1065172, different_count: 84130
# THRESHOLD: 20, same_count: 1067422, different_count: 81880
# THRESHOLD: 21, same_count: 1070061, different_count: 79241
# THRESHOLD: 22, same_count: 1071915, different_count: 77387
# THRESHOLD: 23, same_count: 1073685, different_count: 75617
# THRESHOLD: 24, same_count: 1075143, different_count: 74159
# THRESHOLD: 25, same_count: 1076577, different_count: 72725
# THRESHOLD: 26, same_count: 1077948, different_count: 71354
# THRESHOLD: 27, same_count: 1079586, different_count: 69716
# THRESHOLD: 28, same_count: 1080879, different_count: 68423
# THRESHOLD: 29, same_count: 1082293, different_count: 67009
# THRESHOLD: 30, same_count: 1083823, different_count: 65479
# THRESHOLD: 31, same_count: 1085471, different_count: 63831
# THRESHOLD: 32, same_count: 1086813, different_count: 62489
# THRESHOLD: 33, same_count: 1088047, different_count: 61255
# THRESHOLD: 34, same_count: 1089425, different_count: 59877
# THRESHOLD: 35, same_count: 1090799, different_count: 58503
# THRESHOLD: 36, same_count: 1092320, different_count: 56982
# THRESHOLD: 37, same_count: 1093641, different_count: 55661
# THRESHOLD: 38, same_count: 1094939, different_count: 54363
# THRESHOLD: 39, same_count: 1096173, different_count: 53129
# THRESHOLD: 40, same_count: 1097321, different_count: 51981
# THRESHOLD: 41, same_count: 1098545, different_count: 50757
# THRESHOLD: 42, same_count: 1099610, different_count: 49692
# THRESHOLD: 43, same_count: 1100631, different_count: 48671
# THRESHOLD: 44, same_count: 1101509, different_count: 47793
# THRESHOLD: 45, same_count: 1102266, different_count: 47036
# THRESHOLD: 46, same_count: 1102995, different_count: 46307
# THRESHOLD: 47, same_count: 1103692, different_count: 45610
# THRESHOLD: 48, same_count: 1104350, different_count: 44952
# THRESHOLD: 49, same_count: 1104973, different_count: 44329
# THRESHOLD: 50, same_count: 1105543, different_count: 43759
# THRESHOLD: 51, same_count: 1106097, different_count: 43205
# THRESHOLD: 52, same_count: 1106973, different_count: 42329
# THRESHOLD: 53, same_count: 1107543, different_count: 41759
# THRESHOLD: 54, same_count: 1108226, different_count: 41076
# THRESHOLD: 55, same_count: 1110278, different_count: 39024
# THRESHOLD: 56, same_count: 1113310, different_count: 35992
# THRESHOLD: 57, same_count: 1113738, different_count: 35564
# THRESHOLD: 58, same_count: 1114402, different_count: 34900
# THRESHOLD: 59, same_count: 1114801, different_count: 34501
# THRESHOLD: 60, same_count: 1115235, different_count: 34067
# THRESHOLD: 61, same_count: 1115668, different_count: 33634
# THRESHOLD: 62, same_count: 1116139, different_count: 33163
# THRESHOLD: 63, same_count: 1116544, different_count: 32758
# THRESHOLD: 64, same_count: 1117070, different_count: 32232
# THRESHOLD: 65, same_count: 1117543, different_count: 31759
# THRESHOLD: 66, same_count: 1117824, different_count: 31478
# THRESHOLD: 67, same_count: 1118219, different_count: 31083
# THRESHOLD: 68, same_count: 1120199, different_count: 29103
# THRESHOLD: 69, same_count: 1120836, different_count: 28466
# THRESHOLD: 70, same_count: 1121889, different_count: 27413
# THRESHOLD: 71, same_count: 1122853, different_count: 26449
# THRESHOLD: 72, same_count: 1123514, different_count: 25788
# THRESHOLD: 73, same_count: 1124426, different_count: 24876
# THRESHOLD: 74, same_count: 1125250, different_count: 24052
# THRESHOLD: 75, same_count: 1125557, different_count: 23745
# THRESHOLD: 76, same_count: 1125795, different_count: 23507
# THRESHOLD: 77, same_count: 1126016, different_count: 23286
# THRESHOLD: 78, same_count: 1126269, different_count: 23033
# THRESHOLD: 79, same_count: 1126478, different_count: 22824
# THRESHOLD: 80, same_count: 1126692, different_count: 22610
# THRESHOLD: 81, same_count: 1126972, different_count: 22330
# THRESHOLD: 82, same_count: 1127274, different_count: 22028
# THRESHOLD: 83, same_count: 1127533, different_count: 21769
# THRESHOLD: 84, same_count: 1128832, different_count: 20470
# THRESHOLD: 85, same_count: 1129017, different_count: 20285
# THRESHOLD: 86, same_count: 1129290, different_count: 20012
# THRESHOLD: 87, same_count: 1129606, different_count: 19696
# THRESHOLD: 88, same_count: 1129750, different_count: 19552
# THRESHOLD: 89, same_count: 1130024, different_count: 19278
# THRESHOLD: 90, same_count: 1130212, different_count: 19090
# THRESHOLD: 91, same_count: 1130883, different_count: 18419
# THRESHOLD: 92, same_count: 1131546, different_count: 17756
# THRESHOLD: 93, same_count: 1131927, different_count: 17375
# THRESHOLD: 94, same_count: 1132308, different_count: 16994
# THRESHOLD: 95, same_count: 1132698, different_count: 16604
# THRESHOLD: 96, same_count: 1132906, different_count: 16396
# THRESHOLD: 97, same_count: 1133072, different_count: 16230
# THRESHOLD: 98, same_count: 1133219, different_count: 16083
# THRESHOLD: 99, same_count: 1133376, different_count: 15926
# THRESHOLD: 100, same_count: 1133677, different_count: 15625
# THRESHOLD: 101, same_count: 1133928, different_count: 15374
# THRESHOLD: 102, same_count: 1134087, different_count: 15215
# THRESHOLD: 103, same_count: 1134232, different_count: 15070
# THRESHOLD: 104, same_count: 1134406, different_count: 14896
# THRESHOLD: 105, same_count: 1134577, different_count: 14725
# THRESHOLD: 106, same_count: 1134827, different_count: 14475
# THRESHOLD: 107, same_count: 1135027, different_count: 14275
# THRESHOLD: 108, same_count: 1135238, different_count: 14064
# THRESHOLD: 109, same_count: 1135370, different_count: 13932
# THRESHOLD: 110, same_count: 1135490, different_count: 13812
# THRESHOLD: 111, same_count: 1135762, different_count: 13540
# THRESHOLD: 112, same_count: 1136057, different_count: 13245
# THRESHOLD: 113, same_count: 1136341, different_count: 12961
# THRESHOLD: 114, same_count: 1136540, different_count: 12762
# THRESHOLD: 115, same_count: 1136880, different_count: 12422
# THRESHOLD: 116, same_count: 1137007, different_count: 12295
# THRESHOLD: 117, same_count: 1137133, different_count: 12169
# THRESHOLD: 118, same_count: 1137310, different_count: 11992
# THRESHOLD: 119, same_count: 1138032, different_count: 11270
# THRESHOLD: 120, same_count: 1138438, different_count: 10864
# THRESHOLD: 121, same_count: 1138652, different_count: 10650
# THRESHOLD: 122, same_count: 1138824, different_count: 10478
# THRESHOLD: 123, same_count: 1138961, different_count: 10341
# THRESHOLD: 124, same_count: 1139117, different_count: 10185
# THRESHOLD: 125, same_count: 1139279, different_count: 10023
# THRESHOLD: 126, same_count: 1139549, different_count: 9753
# THRESHOLD: 127, same_count: 1139631, different_count: 9671
# THRESHOLD: 128, same_count: 1139732, different_count: 9570
# THRESHOLD: 129, same_count: 1139811, different_count: 9491
# THRESHOLD: 130, same_count: 1139892, different_count: 9410
# THRESHOLD: 131, same_count: 1139996, different_count: 9306
# THRESHOLD: 132, same_count: 1140070, different_count: 9232
# THRESHOLD: 133, same_count: 1140130, different_count: 9172
# THRESHOLD: 134, same_count: 1140206, different_count: 9096
# THRESHOLD: 135, same_count: 1140305, different_count: 8997
# THRESHOLD: 136, same_count: 1140373, different_count: 8929
# THRESHOLD: 137, same_count: 1140438, different_count: 8864
# THRESHOLD: 138, same_count: 1140516, different_count: 8786
# THRESHOLD: 139, same_count: 1140849, different_count: 8453
# THRESHOLD: 140, same_count: 1140912, different_count: 8390
# THRESHOLD: 141, same_count: 1141040, different_count: 8262
# THRESHOLD: 142, same_count: 1141125, different_count: 8177
# THRESHOLD: 143, same_count: 1141309, different_count: 7993
# THRESHOLD: 144, same_count: 1141368, different_count: 7934
# THRESHOLD: 145, same_count: 1141451, different_count: 7851
# THRESHOLD: 146, same_count: 1141504, different_count: 7798
# THRESHOLD: 147, same_count: 1141575, different_count: 7727
# THRESHOLD: 148, same_count: 1141642, different_count: 7660
# THRESHOLD: 149, same_count: 1141734, different_count: 7568
# THRESHOLD: 150, same_count: 1141802, different_count: 7500
# THRESHOLD: 151, same_count: 1141865, different_count: 7437
# THRESHOLD: 152, same_count: 1141956, different_count: 7346
# THRESHOLD: 153, same_count: 1142009, different_count: 7293
# THRESHOLD: 154, same_count: 1142049, different_count: 7253
# THRESHOLD: 155, same_count: 1142097, different_count: 7205
# THRESHOLD: 156, same_count: 1142272, different_count: 7030
# THRESHOLD: 157, same_count: 1142404, different_count: 6898
# THRESHOLD: 158, same_count: 1142518, different_count: 6784
# THRESHOLD: 159, same_count: 1142588, different_count: 6714
# THRESHOLD: 160, same_count: 1142649, different_count: 6653
# THRESHOLD: 161, same_count: 1142698, different_count: 6604
# THRESHOLD: 162, same_count: 1142742, different_count: 6560
# THRESHOLD: 163, same_count: 1142811, different_count: 6491
# THRESHOLD: 164, same_count: 1142864, different_count: 6438
# THRESHOLD: 165, same_count: 1142925, different_count: 6377
# THRESHOLD: 166, same_count: 1143080, different_count: 6222
# THRESHOLD: 167, same_count: 1143162, different_count: 6140
# THRESHOLD: 168, same_count: 1143213, different_count: 6089
# THRESHOLD: 169, same_count: 1143262, different_count: 6040
# THRESHOLD: 170, same_count: 1143307, different_count: 5995
# THRESHOLD: 171, same_count: 1143353, different_count: 5949
# THRESHOLD: 172, same_count: 1143384, different_count: 5918
# THRESHOLD: 173, same_count: 1143435, different_count: 5867
# THRESHOLD: 174, same_count: 1143487, different_count: 5815
# THRESHOLD: 175, same_count: 1143552, different_count: 5750
# THRESHOLD: 176, same_count: 1143610, different_count: 5692
# THRESHOLD: 177, same_count: 1143645, different_count: 5657
# THRESHOLD: 178, same_count: 1143695, different_count: 5607
# THRESHOLD: 179, same_count: 1143744, different_count: 5558
# THRESHOLD: 180, same_count: 1143792, different_count: 5510
# THRESHOLD: 181, same_count: 1143833, different_count: 5469
# THRESHOLD: 182, same_count: 1143880, different_count: 5422
# THRESHOLD: 183, same_count: 1143908, different_count: 5394
# THRESHOLD: 184, same_count: 1143945, different_count: 5357
# THRESHOLD: 185, same_count: 1143999, different_count: 5303
# THRESHOLD: 186, same_count: 1144027, different_count: 5275
# THRESHOLD: 187, same_count: 1144061, different_count: 5241
# THRESHOLD: 188, same_count: 1144098, different_count: 5204
# THRESHOLD: 189, same_count: 1144121, different_count: 5181
# THRESHOLD: 190, same_count: 1144175, different_count: 5127
# THRESHOLD: 191, same_count: 1144240, different_count: 5062
# THRESHOLD: 192, same_count: 1144309, different_count: 4993
# THRESHOLD: 193, same_count: 1144366, different_count: 4936
# THRESHOLD: 194, same_count: 1144391, different_count: 4911
# THRESHOLD: 195, same_count: 1144428, different_count: 4874
# THRESHOLD: 196, same_count: 1144455, different_count: 4847
# THRESHOLD: 197, same_count: 1144507, different_count: 4795
# THRESHOLD: 198, same_count: 1144578, different_count: 4724
# THRESHOLD: 199, same_count: 1144610, different_count: 4692
# THRESHOLD: 200, same_count: 1144640, different_count: 4662
# THRESHOLD: 201, same_count: 1144657, different_count: 4645
# THRESHOLD: 202, same_count: 1144677, different_count: 4625
# THRESHOLD: 203, same_count: 1144692, different_count: 4610
# THRESHOLD: 204, same_count: 1144708, different_count: 4594
# THRESHOLD: 205, same_count: 1144730, different_count: 4572
# THRESHOLD: 206, same_count: 1144762, different_count: 4540
# THRESHOLD: 207, same_count: 1144779, different_count: 4523
# THRESHOLD: 208, same_count: 1144798, different_count: 4504
# THRESHOLD: 209, same_count: 1144827, different_count: 4475
# THRESHOLD: 210, same_count: 1144836, different_count: 4466
# THRESHOLD: 211, same_count: 1144889, different_count: 4413
# THRESHOLD: 212, same_count: 1144922, different_count: 4380
# THRESHOLD: 213, same_count: 1144952, different_count: 4350
# THRESHOLD: 214, same_count: 1144973, different_count: 4329
# THRESHOLD: 215, same_count: 1144993, different_count: 4309
# THRESHOLD: 216, same_count: 1145004, different_count: 4298
# THRESHOLD: 217, same_count: 1145014, different_count: 4288
# THRESHOLD: 218, same_count: 1145028, different_count: 4274
# THRESHOLD: 219, same_count: 1145047, different_count: 4255
# THRESHOLD: 220, same_count: 1145072, different_count: 4230
# THRESHOLD: 221, same_count: 1145087, different_count: 4215
# THRESHOLD: 222, same_count: 1145108, different_count: 4194
# THRESHOLD: 223, same_count: 1145126, different_count: 4176
# THRESHOLD: 224, same_count: 1145144, different_count: 4158
# THRESHOLD: 225, same_count: 1145153, different_count: 4149
# THRESHOLD: 226, same_count: 1145166, different_count: 4136
# THRESHOLD: 227, same_count: 1145177, different_count: 4125
# THRESHOLD: 228, same_count: 1145193, different_count: 4109
# THRESHOLD: 229, same_count: 1145209, different_count: 4093
# THRESHOLD: 230, same_count: 1145228, different_count: 4074
# THRESHOLD: 231, same_count: 1145260, different_count: 4042
# THRESHOLD: 232, same_count: 1145274, different_count: 4028
# THRESHOLD: 233, same_count: 1145302, different_count: 4000
# THRESHOLD: 234, same_count: 1145500, different_count: 3802
# THRESHOLD: 235, same_count: 1145512, different_count: 3790
# THRESHOLD: 236, same_count: 1145523, different_count: 3779
# THRESHOLD: 237, same_count: 1145553, different_count: 3749
# THRESHOLD: 238, same_count: 1145572, different_count: 3730
# THRESHOLD: 239, same_count: 1145582, different_count: 3720
# THRESHOLD: 240, same_count: 1145595, different_count: 3707
# THRESHOLD: 241, same_count: 1145609, different_count: 3693
# THRESHOLD: 242, same_count: 1145618, different_count: 3684
# THRESHOLD: 243, same_count: 1145633, different_count: 3669
# THRESHOLD: 244, same_count: 1145646, different_count: 3656
# THRESHOLD: 245, same_count: 1145658, different_count: 3644
# THRESHOLD: 246, same_count: 1145828, different_count: 3474
# THRESHOLD: 247, same_count: 1145874, different_count: 3428
# THRESHOLD: 248, same_count: 1145904, different_count: 3398
# THRESHOLD: 249, same_count: 1145922, different_count: 3380
# THRESHOLD: 250, same_count: 1145973, different_count: 3329
# THRESHOLD: 251, same_count: 1146002, different_count: 3300
# THRESHOLD: 252, same_count: 1146017, different_count: 3285
# THRESHOLD: 253, same_count: 1146037, different_count: 3265
# THRESHOLD: 254, same_count: 1146061, different_count: 3241
# THRESHOLD: 255, same_count: 1146082, different_count: 3220
# THRESHOLD: 256, same_count: 1146113, different_count: 3189
# THRESHOLD: 257, same_count: 1146126, different_count: 3176
# THRESHOLD: 258, same_count: 1146141, different_count: 3161
# THRESHOLD: 259, same_count: 1146158, different_count: 3144
# THRESHOLD: 260, same_count: 1146185, different_count: 3117
# THRESHOLD: 261, same_count: 1146205, different_count: 3097
# THRESHOLD: 262, same_count: 1146213, different_count: 3089
# THRESHOLD: 263, same_count: 1146281, different_count: 3021
# THRESHOLD: 264, same_count: 1146318, different_count: 2984
# THRESHOLD: 265, same_count: 1146349, different_count: 2953
# THRESHOLD: 266, same_count: 1146374, different_count: 2928
# THRESHOLD: 267, same_count: 1146379, different_count: 2923
# THRESHOLD: 268, same_count: 1146389, different_count: 2913
# THRESHOLD: 269, same_count: 1146394, different_count: 2908
# THRESHOLD: 270, same_count: 1146409, different_count: 2893
# THRESHOLD: 271, same_count: 1146425, different_count: 2877
# THRESHOLD: 272, same_count: 1146429, different_count: 2873
# THRESHOLD: 273, same_count: 1146439, different_count: 2863
# THRESHOLD: 274, same_count: 1146446, different_count: 2856
# THRESHOLD: 275, same_count: 1146460, different_count: 2842
# THRESHOLD: 276, same_count: 1146468, different_count: 2834
# THRESHOLD: 277, same_count: 1146487, different_count: 2815
# THRESHOLD: 278, same_count: 1146494, different_count: 2808
# THRESHOLD: 279, same_count: 1146500, different_count: 2802
# THRESHOLD: 280, same_count: 1146580, different_count: 2722
# THRESHOLD: 281, same_count: 1146781, different_count: 2521
# THRESHOLD: 282, same_count: 1146793, different_count: 2509
# THRESHOLD: 283, same_count: 1146810, different_count: 2492
# THRESHOLD: 284, same_count: 1146825, different_count: 2477
# THRESHOLD: 285, same_count: 1146835, different_count: 2467
# THRESHOLD: 286, same_count: 1146843, different_count: 2459
# THRESHOLD: 287, same_count: 1146864, different_count: 2438
# THRESHOLD: 288, same_count: 1146872, different_count: 2430
# THRESHOLD: 289, same_count: 1146878, different_count: 2424
# THRESHOLD: 290, same_count: 1146890, different_count: 2412
# THRESHOLD: 291, same_count: 1147041, different_count: 2261
# THRESHOLD: 292, same_count: 1147106, different_count: 2196
# THRESHOLD: 293, same_count: 1147112, different_count: 2190
# THRESHOLD: 294, same_count: 1147119, different_count: 2183
# THRESHOLD: 295, same_count: 1147132, different_count: 2170
# THRESHOLD: 296, same_count: 1147137, different_count: 2165
# THRESHOLD: 297, same_count: 1147165, different_count: 2137
# THRESHOLD: 298, same_count: 1147176, different_count: 2126
# THRESHOLD: 299, same_count: 1147178, different_count: 2124
# THRESHOLD: 300, same_count: 1147187, different_count: 2115
# THRESHOLD: 301, same_count: 1147194, different_count: 2108
# THRESHOLD: 302, same_count: 1147209, different_count: 2093
# THRESHOLD: 303, same_count: 1147214, different_count: 2088
# THRESHOLD: 304, same_count: 1147222, different_count: 2080
# THRESHOLD: 305, same_count: 1147227, different_count: 2075
# THRESHOLD: 306, same_count: 1147236, different_count: 2066
# THRESHOLD: 307, same_count: 1147242, different_count: 2060
# THRESHOLD: 308, same_count: 1147249, different_count: 2053
# THRESHOLD: 309, same_count: 1147256, different_count: 2046
# THRESHOLD: 310, same_count: 1147262, different_count: 2040
# THRESHOLD: 311, same_count: 1147273, different_count: 2029
# THRESHOLD: 312, same_count: 1147279, different_count: 2023
# THRESHOLD: 313, same_count: 1147290, different_count: 2012
# THRESHOLD: 314, same_count: 1147322, different_count: 1980
# THRESHOLD: 315, same_count: 1147343, different_count: 1959
# THRESHOLD: 316, same_count: 1147362, different_count: 1940
# THRESHOLD: 317, same_count: 1147425, different_count: 1877
# THRESHOLD: 318, same_count: 1147489, different_count: 1813
# THRESHOLD: 319, same_count: 1147498, different_count: 1804
# THRESHOLD: 320, same_count: 1147523, different_count: 1779
# THRESHOLD: 321, same_count: 1147538, different_count: 1764
# THRESHOLD: 322, same_count: 1147544, different_count: 1758
# THRESHOLD: 323, same_count: 1147556, different_count: 1746
# THRESHOLD: 324, same_count: 1147567, different_count: 1735
# THRESHOLD: 325, same_count: 1147570, different_count: 1732
# THRESHOLD: 326, same_count: 1147580, different_count: 1722
# THRESHOLD: 327, same_count: 1147589, different_count: 1713
# THRESHOLD: 328, same_count: 1147598, different_count: 1704
# THRESHOLD: 329, same_count: 1147620, different_count: 1682
# THRESHOLD: 330, same_count: 1147636, different_count: 1666
# THRESHOLD: 331, same_count: 1147651, different_count: 1651
# THRESHOLD: 332, same_count: 1147660, different_count: 1642
# THRESHOLD: 333, same_count: 1147665, different_count: 1637
# THRESHOLD: 334, same_count: 1147670, different_count: 1632
# THRESHOLD: 335, same_count: 1147675, different_count: 1627
# THRESHOLD: 336, same_count: 1147679, different_count: 1623
# THRESHOLD: 337, same_count: 1147687, different_count: 1615
# THRESHOLD: 338, same_count: 1147699, different_count: 1603
# THRESHOLD: 339, same_count: 1147702, different_count: 1600
# THRESHOLD: 340, same_count: 1147706, different_count: 1596
# THRESHOLD: 341, same_count: 1147713, different_count: 1589
# THRESHOLD: 342, same_count: 1147722, different_count: 1580
# THRESHOLD: 343, same_count: 1147731, different_count: 1571
# THRESHOLD: 344, same_count: 1147746, different_count: 1556
# THRESHOLD: 345, same_count: 1147753, different_count: 1549
# THRESHOLD: 346, same_count: 1147766, different_count: 1536
# THRESHOLD: 347, same_count: 1147778, different_count: 1524
# THRESHOLD: 348, same_count: 1147787, different_count: 1515
# THRESHOLD: 349, same_count: 1147794, different_count: 1508
# THRESHOLD: 350, same_count: 1147802, different_count: 1500
# THRESHOLD: 351, same_count: 1147804, different_count: 1498
# THRESHOLD: 352, same_count: 1147810, different_count: 1492
# THRESHOLD: 353, same_count: 1147819, different_count: 1483
# THRESHOLD: 354, same_count: 1147826, different_count: 1476
# THRESHOLD: 355, same_count: 1147834, different_count: 1468
# THRESHOLD: 356, same_count: 1147843, different_count: 1459
# THRESHOLD: 357, same_count: 1147849, different_count: 1453
# THRESHOLD: 358, same_count: 1147853, different_count: 1449
# THRESHOLD: 359, same_count: 1147872, different_count: 1430
# THRESHOLD: 360, same_count: 1147876, different_count: 1426
# THRESHOLD: 361, same_count: 1147881, different_count: 1421
# THRESHOLD: 362, same_count: 1147887, different_count: 1415
# THRESHOLD: 363, same_count: 1147889, different_count: 1413
# THRESHOLD: 364, same_count: 1147901, different_count: 1401
# THRESHOLD: 365, same_count: 1147913, different_count: 1389
# THRESHOLD: 366, same_count: 1147938, different_count: 1364
# THRESHOLD: 367, same_count: 1147957, different_count: 1345
# THRESHOLD: 368, same_count: 1147965, different_count: 1337
# THRESHOLD: 369, same_count: 1147971, different_count: 1331
# THRESHOLD: 370, same_count: 1147976, different_count: 1326
# THRESHOLD: 371, same_count: 1147981, different_count: 1321
# THRESHOLD: 372, same_count: 1147985, different_count: 1317
# THRESHOLD: 373, same_count: 1147992, different_count: 1310
# THRESHOLD: 374, same_count: 1147998, different_count: 1304
# THRESHOLD: 375, same_count: 1148013, different_count: 1289
# THRESHOLD: 376, same_count: 1148016, different_count: 1286
# THRESHOLD: 377, same_count: 1148017, different_count: 1285
# THRESHOLD: 378, same_count: 1148023, different_count: 1279
# THRESHOLD: 379, same_count: 1148036, different_count: 1266
# THRESHOLD: 380, same_count: 1148042, different_count: 1260
# THRESHOLD: 381, same_count: 1148050, different_count: 1252
# THRESHOLD: 382, same_count: 1148054, different_count: 1248
# THRESHOLD: 383, same_count: 1148058, different_count: 1244
# THRESHOLD: 384, same_count: 1148063, different_count: 1239
# THRESHOLD: 385, same_count: 1148070, different_count: 1232
# THRESHOLD: 386, same_count: 1148076, different_count: 1226
# THRESHOLD: 387, same_count: 1148083, different_count: 1219
# THRESHOLD: 388, same_count: 1148091, different_count: 1211
# THRESHOLD: 389, same_count: 1148095, different_count: 1207
# THRESHOLD: 390, same_count: 1148098, different_count: 1204
# THRESHOLD: 391, same_count: 1148101, different_count: 1201
# THRESHOLD: 392, same_count: 1148102, different_count: 1200
# THRESHOLD: 393, same_count: 1148106, different_count: 1196
# THRESHOLD: 394, same_count: 1148113, different_count: 1189
# THRESHOLD: 395, same_count: 1148116, different_count: 1186
# THRESHOLD: 396, same_count: 1148120, different_count: 1182
# THRESHOLD: 397, same_count: 1148351, different_count: 951
# THRESHOLD: 398, same_count: 1148384, different_count: 918
# THRESHOLD: 399, same_count: 1148386, different_count: 916
# THRESHOLD: 400, same_count: 1148389, different_count: 913
# THRESHOLD: 401, same_count: 1148394, different_count: 908
# THRESHOLD: 402, same_count: 1148395, different_count: 907
# THRESHOLD: 403, same_count: 1148396, different_count: 906
# THRESHOLD: 404, same_count: 1148399, different_count: 903
# THRESHOLD: 405, same_count: 1148421, different_count: 881
# THRESHOLD: 406, same_count: 1148435, different_count: 867
# THRESHOLD: 407, same_count: 1148470, different_count: 832
# THRESHOLD: 408, same_count: 1148475, different_count: 827
# THRESHOLD: 409, same_count: 1148501, different_count: 801
# THRESHOLD: 410, same_count: 1148506, different_count: 796
# THRESHOLD: 411, same_count: 1148511, different_count: 791
# THRESHOLD: 412, same_count: 1148513, different_count: 789
# THRESHOLD: 413, same_count: 1148514, different_count: 788
# THRESHOLD: 414, same_count: 1148514, different_count: 788
# THRESHOLD: 415, same_count: 1148518, different_count: 784
# THRESHOLD: 416, same_count: 1148522, different_count: 780
# THRESHOLD: 417, same_count: 1148528, different_count: 774
# THRESHOLD: 418, same_count: 1148537, different_count: 765
# THRESHOLD: 419, same_count: 1148540, different_count: 762
# THRESHOLD: 420, same_count: 1148540, different_count: 762
# THRESHOLD: 421, same_count: 1148551, different_count: 751
# THRESHOLD: 422, same_count: 1148563, different_count: 739
# THRESHOLD: 423, same_count: 1148588, different_count: 714
# THRESHOLD: 424, same_count: 1148603, different_count: 699
# THRESHOLD: 425, same_count: 1148679, different_count: 623
# THRESHOLD: 426, same_count: 1148685, different_count: 617
# THRESHOLD: 427, same_count: 1148688, different_count: 614
# THRESHOLD: 428, same_count: 1148701, different_count: 601
# THRESHOLD: 429, same_count: 1148706, different_count: 596
# THRESHOLD: 430, same_count: 1148708, different_count: 594
# THRESHOLD: 431, same_count: 1148710, different_count: 592
# THRESHOLD: 432, same_count: 1148712, different_count: 590
# THRESHOLD: 433, same_count: 1148716, different_count: 586
# THRESHOLD: 434, same_count: 1148721, different_count: 581
# THRESHOLD: 435, same_count: 1148726, different_count: 576
# THRESHOLD: 436, same_count: 1148728, different_count: 574
# THRESHOLD: 437, same_count: 1148730, different_count: 572
# THRESHOLD: 438, same_count: 1148734, different_count: 568
# THRESHOLD: 439, same_count: 1148735, different_count: 567
# THRESHOLD: 440, same_count: 1148735, different_count: 567
# THRESHOLD: 441, same_count: 1148745, different_count: 557
# THRESHOLD: 442, same_count: 1148756, different_count: 546
# THRESHOLD: 443, same_count: 1148758, different_count: 544
# THRESHOLD: 444, same_count: 1148759, different_count: 543
# THRESHOLD: 445, same_count: 1148759, different_count: 543
# THRESHOLD: 446, same_count: 1148760, different_count: 542
# THRESHOLD: 447, same_count: 1148762, different_count: 540
# THRESHOLD: 448, same_count: 1148762, different_count: 540
# THRESHOLD: 449, same_count: 1148765, different_count: 537
# THRESHOLD: 450, same_count: 1148765, different_count: 537
# THRESHOLD: 451, same_count: 1148766, different_count: 536
# THRESHOLD: 452, same_count: 1148766, different_count: 536
# THRESHOLD: 453, same_count: 1148766, different_count: 536
# THRESHOLD: 454, same_count: 1148771, different_count: 531
# THRESHOLD: 455, same_count: 1148773, different_count: 529
# THRESHOLD: 456, same_count: 1148777, different_count: 525
# THRESHOLD: 457, same_count: 1148778, different_count: 524
# THRESHOLD: 458, same_count: 1148781, different_count: 521
# THRESHOLD: 459, same_count: 1148781, different_count: 521
# THRESHOLD: 460, same_count: 1148781, different_count: 521
# THRESHOLD: 461, same_count: 1148786, different_count: 516
# THRESHOLD: 462, same_count: 1148791, different_count: 511
# THRESHOLD: 463, same_count: 1148793, different_count: 509
# THRESHOLD: 464, same_count: 1148793, different_count: 509
# THRESHOLD: 465, same_count: 1148797, different_count: 505
# THRESHOLD: 466, same_count: 1148798, different_count: 504
# THRESHOLD: 467, same_count: 1148798, different_count: 504
# THRESHOLD: 468, same_count: 1148799, different_count: 503
# THRESHOLD: 469, same_count: 1148801, different_count: 501
# THRESHOLD: 470, same_count: 1148801, different_count: 501
# THRESHOLD: 471, same_count: 1148801, different_count: 501
# THRESHOLD: 472, same_count: 1148804, different_count: 498
# THRESHOLD: 473, same_count: 1148816, different_count: 486
# THRESHOLD: 474, same_count: 1148819, different_count: 483
# THRESHOLD: 475, same_count: 1148820, different_count: 482
# THRESHOLD: 476, same_count: 1148822, different_count: 480
# THRESHOLD: 477, same_count: 1148824, different_count: 478
# THRESHOLD: 478, same_count: 1148824, different_count: 478
# THRESHOLD: 479, same_count: 1148825, different_count: 477
# THRESHOLD: 480, same_count: 1148826, different_count: 476
# THRESHOLD: 481, same_count: 1148827, different_count: 475
# THRESHOLD: 482, same_count: 1148828, different_count: 474
# THRESHOLD: 483, same_count: 1148829, different_count: 473
# THRESHOLD: 484, same_count: 1148829, different_count: 473
# THRESHOLD: 485, same_count: 1148829, different_count: 473
# THRESHOLD: 486, same_count: 1148830, different_count: 472
# THRESHOLD: 487, same_count: 1148833, different_count: 469
# THRESHOLD: 488, same_count: 1148833, different_count: 469
# THRESHOLD: 489, same_count: 1148844, different_count: 458
# THRESHOLD: 490, same_count: 1148847, different_count: 455
# THRESHOLD: 491, same_count: 1148847, different_count: 455
# THRESHOLD: 492, same_count: 1148847, different_count: 455
# THRESHOLD: 493, same_count: 1148848, different_count: 454
# THRESHOLD: 494, same_count: 1148849, different_count: 453
# THRESHOLD: 495, same_count: 1148849, different_count: 453
# THRESHOLD: 496, same_count: 1148850, different_count: 452
# THRESHOLD: 497, same_count: 1148851, different_count: 451
# THRESHOLD: 498, same_count: 1148853, different_count: 449
# THRESHOLD: 499, same_count: 1148856, different_count: 446
# THRESHOLD: 500, same_count: 1148868, different_count: 434
# THRESHOLD: 501, same_count: 1148870, different_count: 432
# THRESHOLD: 502, same_count: 1148871, different_count: 431
# THRESHOLD: 503, same_count: 1148874, different_count: 428
# THRESHOLD: 504, same_count: 1148877, different_count: 425
# THRESHOLD: 505, same_count: 1148877, different_count: 425
# THRESHOLD: 506, same_count: 1148878, different_count: 424
# THRESHOLD: 507, same_count: 1148879, different_count: 423
# THRESHOLD: 508, same_count: 1148881, different_count: 421
# THRESHOLD: 509, same_count: 1148882, different_count: 420
# THRESHOLD: 510, same_count: 1148883, different_count: 419
# THRESHOLD: 511, same_count: 1148883, different_count: 419
# THRESHOLD: 512, same_count: 1148884, different_count: 418
# THRESHOLD: 513, same_count: 1148885, different_count: 417
# THRESHOLD: 514, same_count: 1148885, different_count: 417
# THRESHOLD: 515, same_count: 1148885, different_count: 417
# THRESHOLD: 516, same_count: 1148888, different_count: 414
# THRESHOLD: 517, same_count: 1148889, different_count: 413
# THRESHOLD: 518, same_count: 1148890, different_count: 412
# THRESHOLD: 519, same_count: 1148890, different_count: 412
# THRESHOLD: 520, same_count: 1148891, different_count: 411
# THRESHOLD: 521, same_count: 1148894, different_count: 408
# THRESHOLD: 522, same_count: 1148894, different_count: 408
# THRESHOLD: 523, same_count: 1148895, different_count: 407
# THRESHOLD: 524, same_count: 1148895, different_count: 407
# THRESHOLD: 525, same_count: 1148895, different_count: 407
# THRESHOLD: 526, same_count: 1148896, different_count: 406
# THRESHOLD: 527, same_count: 1148896, different_count: 406
# THRESHOLD: 528, same_count: 1148897, different_count: 405
# THRESHOLD: 529, same_count: 1148898, different_count: 404
# THRESHOLD: 530, same_count: 1148899, different_count: 403
# THRESHOLD: 531, same_count: 1148899, different_count: 403
# THRESHOLD: 532, same_count: 1148900, different_count: 402
# THRESHOLD: 533, same_count: 1148903, different_count: 399
# THRESHOLD: 534, same_count: 1148903, different_count: 399
# THRESHOLD: 535, same_count: 1148904, different_count: 398
# THRESHOLD: 536, same_count: 1148904, different_count: 398
# THRESHOLD: 537, same_count: 1148905, different_count: 397
# THRESHOLD: 538, same_count: 1148907, different_count: 395
# THRESHOLD: 539, same_count: 1148907, different_count: 395
# THRESHOLD: 540, same_count: 1148907, different_count: 395
# THRESHOLD: 541, same_count: 1148907, different_count: 395
# THRESHOLD: 542, same_count: 1148909, different_count: 393
# THRESHOLD: 543, same_count: 1148909, different_count: 393
# THRESHOLD: 544, same_count: 1148911, different_count: 391
# THRESHOLD: 545, same_count: 1148913, different_count: 389
# THRESHOLD: 546, same_count: 1148915, different_count: 387
# THRESHOLD: 547, same_count: 1148915, different_count: 387
# THRESHOLD: 548, same_count: 1148915, different_count: 387
# THRESHOLD: 549, same_count: 1148927, different_count: 375
# THRESHOLD: 550, same_count: 1148927, different_count: 375
# THRESHOLD: 551, same_count: 1148927, different_count: 375
# THRESHOLD: 552, same_count: 1148928, different_count: 374
# THRESHOLD: 553, same_count: 1148958, different_count: 344
# THRESHOLD: 554, same_count: 1148960, different_count: 342
# THRESHOLD: 555, same_count: 1148960, different_count: 342
# THRESHOLD: 556, same_count: 1148960, different_count: 342
# THRESHOLD: 557, same_count: 1148960, different_count: 342
# THRESHOLD: 558, same_count: 1148996, different_count: 306
# THRESHOLD: 559, same_count: 1148996, different_count: 306
# THRESHOLD: 560, same_count: 1148996, different_count: 306
# THRESHOLD: 561, same_count: 1148996, different_count: 306
# THRESHOLD: 562, same_count: 1148997, different_count: 305
# THRESHOLD: 563, same_count: 1148997, different_count: 305
# THRESHOLD: 564, same_count: 1148997, different_count: 305
# THRESHOLD: 565, same_count: 1148998, different_count: 304
# THRESHOLD: 566, same_count: 1148998, different_count: 304
# THRESHOLD: 567, same_count: 1148998, different_count: 304
# THRESHOLD: 568, same_count: 1148998, different_count: 304
# THRESHOLD: 569, same_count: 1148998, different_count: 304
# THRESHOLD: 570, same_count: 1148999, different_count: 303
# THRESHOLD: 571, same_count: 1148999, different_count: 303
# THRESHOLD: 572, same_count: 1148999, different_count: 303
# THRESHOLD: 573, same_count: 1148999, different_count: 303
# THRESHOLD: 574, same_count: 1149000, different_count: 302
# THRESHOLD: 575, same_count: 1149000, different_count: 302
# THRESHOLD: 576, same_count: 1149002, different_count: 300
# THRESHOLD: 577, same_count: 1149002, different_count: 300
# THRESHOLD: 578, same_count: 1149002, different_count: 300
# THRESHOLD: 579, same_count: 1149003, different_count: 299
# THRESHOLD: 580, same_count: 1149003, different_count: 299
# THRESHOLD: 581, same_count: 1149003, different_count: 299
# THRESHOLD: 582, same_count: 1149003, different_count: 299
# THRESHOLD: 583, same_count: 1149005, different_count: 297
# THRESHOLD: 584, same_count: 1149005, different_count: 297
# THRESHOLD: 585, same_count: 1149006, different_count: 296
# THRESHOLD: 586, same_count: 1149007, different_count: 295
# THRESHOLD: 587, same_count: 1149008, different_count: 294
# THRESHOLD: 588, same_count: 1149008, different_count: 294
# THRESHOLD: 589, same_count: 1149010, different_count: 292
# THRESHOLD: 590, same_count: 1149010, different_count: 292
# THRESHOLD: 591, same_count: 1149010, different_count: 292
# THRESHOLD: 592, same_count: 1149011, different_count: 291
# THRESHOLD: 593, same_count: 1149011, different_count: 291
# THRESHOLD: 594, same_count: 1149011, different_count: 291
# THRESHOLD: 595, same_count: 1149040, different_count: 262
# THRESHOLD: 596, same_count: 1149054, different_count: 248
# THRESHOLD: 597, same_count: 1149054, different_count: 248
# THRESHOLD: 598, same_count: 1149055, different_count: 247
# THRESHOLD: 599, same_count: 1149055, different_count: 247
# THRESHOLD: 600, same_count: 1149055, different_count: 247
# THRESHOLD: 601, same_count: 1149056, different_count: 246
# THRESHOLD: 602, same_count: 1149057, different_count: 245
# THRESHOLD: 603, same_count: 1149057, different_count: 245
# THRESHOLD: 604, same_count: 1149057, different_count: 245
# THRESHOLD: 605, same_count: 1149060, different_count: 242
# THRESHOLD: 606, same_count: 1149062, different_count: 240
# THRESHOLD: 607, same_count: 1149063, different_count: 239
# THRESHOLD: 608, same_count: 1149063, different_count: 239
# THRESHOLD: 609, same_count: 1149064, different_count: 238
# THRESHOLD: 610, same_count: 1149064, different_count: 238
# THRESHOLD: 611, same_count: 1149065, different_count: 237
# THRESHOLD: 612, same_count: 1149065, different_count: 237
# THRESHOLD: 613, same_count: 1149065, different_count: 237
# THRESHOLD: 614, same_count: 1149065, different_count: 237
# THRESHOLD: 615, same_count: 1149066, different_count: 236
# THRESHOLD: 616, same_count: 1149069, different_count: 233
# THRESHOLD: 617, same_count: 1149072, different_count: 230
# THRESHOLD: 618, same_count: 1149073, different_count: 229
# THRESHOLD: 619, same_count: 1149074, different_count: 228
# THRESHOLD: 620, same_count: 1149074, different_count: 228
# THRESHOLD: 621, same_count: 1149082, different_count: 220
# THRESHOLD: 622, same_count: 1149082, different_count: 220
# THRESHOLD: 623, same_count: 1149082, different_count: 220
# THRESHOLD: 624, same_count: 1149083, different_count: 219
# THRESHOLD: 625, same_count: 1149083, different_count: 219
# THRESHOLD: 626, same_count: 1149085, different_count: 217
# THRESHOLD: 627, same_count: 1149087, different_count: 215
# THRESHOLD: 628, same_count: 1149087, different_count: 215
# THRESHOLD: 629, same_count: 1149087, different_count: 215
# THRESHOLD: 630, same_count: 1149089, different_count: 213
# THRESHOLD: 631, same_count: 1149108, different_count: 194
# THRESHOLD: 632, same_count: 1149108, different_count: 194
# THRESHOLD: 633, same_count: 1149108, different_count: 194
# THRESHOLD: 634, same_count: 1149108, different_count: 194
# THRESHOLD: 635, same_count: 1149109, different_count: 193
# THRESHOLD: 636, same_count: 1149119, different_count: 183
# THRESHOLD: 637, same_count: 1149120, different_count: 182
# THRESHOLD: 638, same_count: 1149120, different_count: 182
# THRESHOLD: 639, same_count: 1149120, different_count: 182
# THRESHOLD: 640, same_count: 1149120, different_count: 182
# THRESHOLD: 641, same_count: 1149121, different_count: 181
# THRESHOLD: 642, same_count: 1149122, different_count: 180
# THRESHOLD: 643, same_count: 1149124, different_count: 178
# THRESHOLD: 644, same_count: 1149124, different_count: 178
# THRESHOLD: 645, same_count: 1149124, different_count: 178
# THRESHOLD: 646, same_count: 1149124, different_count: 178
# THRESHOLD: 647, same_count: 1149125, different_count: 177
# THRESHOLD: 648, same_count: 1149126, different_count: 176
# THRESHOLD: 649, same_count: 1149127, different_count: 175
# THRESHOLD: 650, same_count: 1149129, different_count: 173
# THRESHOLD: 651, same_count: 1149130, different_count: 172
# THRESHOLD: 652, same_count: 1149130, different_count: 172
# THRESHOLD: 653, same_count: 1149130, different_count: 172
# THRESHOLD: 654, same_count: 1149130, different_count: 172
# THRESHOLD: 655, same_count: 1149130, different_count: 172
# THRESHOLD: 656, same_count: 1149131, different_count: 171
# THRESHOLD: 657, same_count: 1149135, different_count: 167
# THRESHOLD: 658, same_count: 1149135, different_count: 167
# THRESHOLD: 659, same_count: 1149135, different_count: 167
# THRESHOLD: 660, same_count: 1149135, different_count: 167
# THRESHOLD: 661, same_count: 1149135, different_count: 167
# THRESHOLD: 662, same_count: 1149136, different_count: 166
# THRESHOLD: 663, same_count: 1149137, different_count: 165
# THRESHOLD: 664, same_count: 1149137, different_count: 165
# THRESHOLD: 665, same_count: 1149137, different_count: 165
# THRESHOLD: 666, same_count: 1149138, different_count: 164
# THRESHOLD: 667, same_count: 1149138, different_count: 164
# THRESHOLD: 668, same_count: 1149138, different_count: 164
# THRESHOLD: 669, same_count: 1149139, different_count: 163
# THRESHOLD: 670, same_count: 1149139, different_count: 163
# THRESHOLD: 671, same_count: 1149139, different_count: 163
# THRESHOLD: 672, same_count: 1149139, different_count: 163
# THRESHOLD: 673, same_count: 1149139, different_count: 163
# THRESHOLD: 674, same_count: 1149139, different_count: 163
# THRESHOLD: 675, same_count: 1149139, different_count: 163
# THRESHOLD: 676, same_count: 1149139, different_count: 163
# THRESHOLD: 677, same_count: 1149140, different_count: 162
# THRESHOLD: 678, same_count: 1149140, different_count: 162
# THRESHOLD: 679, same_count: 1149140, different_count: 162
# THRESHOLD: 680, same_count: 1149140, different_count: 162
# THRESHOLD: 681, same_count: 1149140, different_count: 162
# THRESHOLD: 682, same_count: 1149140, different_count: 162
# THRESHOLD: 683, same_count: 1149140, different_count: 162
# THRESHOLD: 684, same_count: 1149140, different_count: 162
# THRESHOLD: 685, same_count: 1149140, different_count: 162
# THRESHOLD: 686, same_count: 1149141, different_count: 161
# THRESHOLD: 687, same_count: 1149141, different_count: 161
# THRESHOLD: 688, same_count: 1149141, different_count: 161
# THRESHOLD: 689, same_count: 1149141, different_count: 161
# THRESHOLD: 690, same_count: 1149141, different_count: 161
# THRESHOLD: 691, same_count: 1149142, different_count: 160
# THRESHOLD: 692, same_count: 1149142, different_count: 160
# THRESHOLD: 693, same_count: 1149142, different_count: 160
# THRESHOLD: 694, same_count: 1149142, different_count: 160
# THRESHOLD: 695, same_count: 1149143, different_count: 159
# THRESHOLD: 696, same_count: 1149143, different_count: 159
# THRESHOLD: 697, same_count: 1149143, different_count: 159
# THRESHOLD: 698, same_count: 1149143, different_count: 159
# THRESHOLD: 699, same_count: 1149143, different_count: 159
# THRESHOLD: 700, same_count: 1149144, different_count: 158
# THRESHOLD: 701, same_count: 1149144, different_count: 158
# THRESHOLD: 702, same_count: 1149144, different_count: 158
# THRESHOLD: 703, same_count: 1149145, different_count: 157
# THRESHOLD: 704, same_count: 1149145, different_count: 157
# THRESHOLD: 705, same_count: 1149145, different_count: 157
# THRESHOLD: 706, same_count: 1149145, different_count: 157
# THRESHOLD: 707, same_count: 1149145, different_count: 157
# THRESHOLD: 708, same_count: 1149146, different_count: 156
# THRESHOLD: 709, same_count: 1149146, different_count: 156
# THRESHOLD: 710, same_count: 1149146, different_count: 156
# THRESHOLD: 711, same_count: 1149146, different_count: 156
# THRESHOLD: 712, same_count: 1149147, different_count: 155
# THRESHOLD: 713, same_count: 1149147, different_count: 155
# THRESHOLD: 714, same_count: 1149147, different_count: 155
# THRESHOLD: 715, same_count: 1149147, different_count: 155
# THRESHOLD: 716, same_count: 1149147, different_count: 155
# THRESHOLD: 717, same_count: 1149147, different_count: 155
# THRESHOLD: 718, same_count: 1149147, different_count: 155
# THRESHOLD: 719, same_count: 1149147, different_count: 155
# THRESHOLD: 720, same_count: 1149147, different_count: 155
# THRESHOLD: 721, same_count: 1149147, different_count: 155
# THRESHOLD: 722, same_count: 1149147, different_count: 155
# THRESHOLD: 723, same_count: 1149147, different_count: 155
# THRESHOLD: 724, same_count: 1149147, different_count: 155
# THRESHOLD: 725, same_count: 1149147, different_count: 155
# THRESHOLD: 726, same_count: 1149147, different_count: 155
# THRESHOLD: 727, same_count: 1149147, different_count: 155
# THRESHOLD: 728, same_count: 1149147, different_count: 155
# THRESHOLD: 729, same_count: 1149147, different_count: 155
# THRESHOLD: 730, same_count: 1149147, different_count: 155
# THRESHOLD: 731, same_count: 1149147, different_count: 155
# THRESHOLD: 732, same_count: 1149147, different_count: 155
# THRESHOLD: 733, same_count: 1149147, different_count: 155
# THRESHOLD: 734, same_count: 1149147, different_count: 155
# THRESHOLD: 735, same_count: 1149147, different_count: 155
# THRESHOLD: 736, same_count: 1149147, different_count: 155
# THRESHOLD: 737, same_count: 1149148, different_count: 154
# THRESHOLD: 738, same_count: 1149148, different_count: 154
# THRESHOLD: 739, same_count: 1149149, different_count: 153
# THRESHOLD: 740, same_count: 1149150, different_count: 152
# THRESHOLD: 741, same_count: 1149150, different_count: 152
# THRESHOLD: 742, same_count: 1149150, different_count: 152
# THRESHOLD: 743, same_count: 1149150, different_count: 152
# THRESHOLD: 744, same_count: 1149151, different_count: 151
# THRESHOLD: 745, same_count: 1149151, different_count: 151
# THRESHOLD: 746, same_count: 1149152, different_count: 150
# THRESHOLD: 747, same_count: 1149152, different_count: 150
# THRESHOLD: 748, same_count: 1149152, different_count: 150
# THRESHOLD: 749, same_count: 1149152, different_count: 150
# THRESHOLD: 750, same_count: 1149152, different_count: 150
# THRESHOLD: 751, same_count: 1149153, different_count: 149
# THRESHOLD: 752, same_count: 1149153, different_count: 149
# THRESHOLD: 753, same_count: 1149153, different_count: 149
# THRESHOLD: 754, same_count: 1149154, different_count: 148
# THRESHOLD: 755, same_count: 1149155, different_count: 147
# THRESHOLD: 756, same_count: 1149155, different_count: 147
# THRESHOLD: 757, same_count: 1149155, different_count: 147
# THRESHOLD: 758, same_count: 1149155, different_count: 147
# THRESHOLD: 759, same_count: 1149155, different_count: 147
# THRESHOLD: 760, same_count: 1149155, different_count: 147
# THRESHOLD: 761, same_count: 1149155, different_count: 147
# THRESHOLD: 762, same_count: 1149155, different_count: 147
# THRESHOLD: 763, same_count: 1149155, different_count: 147
# THRESHOLD: 764, same_count: 1149155, different_count: 147
# THRESHOLD: 765, same_count: 1149155, different_count: 147
# THRESHOLD: 766, same_count: 1149156, different_count: 146
# THRESHOLD: 767, same_count: 1149156, different_count: 146
# THRESHOLD: 768, same_count: 1149156, different_count: 146
# THRESHOLD: 769, same_count: 1149156, different_count: 146
# THRESHOLD: 770, same_count: 1149157, different_count: 145
# THRESHOLD: 771, same_count: 1149157, different_count: 145
# THRESHOLD: 772, same_count: 1149157, different_count: 145
# THRESHOLD: 773, same_count: 1149157, different_count: 145
# THRESHOLD: 774, same_count: 1149157, different_count: 145
# THRESHOLD: 775, same_count: 1149157, different_count: 145
# THRESHOLD: 776, same_count: 1149157, different_count: 145
# THRESHOLD: 777, same_count: 1149157, different_count: 145
# THRESHOLD: 778, same_count: 1149175, different_count: 127
# THRESHOLD: 779, same_count: 1149175, different_count: 127
# THRESHOLD: 780, same_count: 1149175, different_count: 127
# THRESHOLD: 781, same_count: 1149175, different_count: 127
# THRESHOLD: 782, same_count: 1149175, different_count: 127
# THRESHOLD: 783, same_count: 1149189, different_count: 113
# THRESHOLD: 784, same_count: 1149189, different_count: 113
# THRESHOLD: 785, same_count: 1149190, different_count: 112
# THRESHOLD: 786, same_count: 1149190, different_count: 112
# THRESHOLD: 787, same_count: 1149237, different_count: 65
# THRESHOLD: 788, same_count: 1149237, different_count: 65
# THRESHOLD: 789, same_count: 1149237, different_count: 65
# THRESHOLD: 790, same_count: 1149237, different_count: 65
# THRESHOLD: 791, same_count: 1149238, different_count: 64
# THRESHOLD: 792, same_count: 1149238, different_count: 64
# THRESHOLD: 793, same_count: 1149238, different_count: 64
# THRESHOLD: 794, same_count: 1149238, different_count: 64
# THRESHOLD: 795, same_count: 1149238, different_count: 64
# THRESHOLD: 796, same_count: 1149238, different_count: 64
# THRESHOLD: 797, same_count: 1149239, different_count: 63
# THRESHOLD: 798, same_count: 1149240, different_count: 62
# THRESHOLD: 799, same_count: 1149240, different_count: 62
# THRESHOLD: 800, same_count: 1149240, different_count: 62
# THRESHOLD: 801, same_count: 1149240, different_count: 62
# THRESHOLD: 802, same_count: 1149241, different_count: 61
# THRESHOLD: 803, same_count: 1149241, different_count: 61
# THRESHOLD: 804, same_count: 1149241, different_count: 61
# THRESHOLD: 805, same_count: 1149241, different_count: 61
# THRESHOLD: 806, same_count: 1149241, different_count: 61
# THRESHOLD: 807, same_count: 1149242, different_count: 60
# THRESHOLD: 808, same_count: 1149242, different_count: 60
# THRESHOLD: 809, same_count: 1149242, different_count: 60
# THRESHOLD: 810, same_count: 1149242, different_count: 60
# THRESHOLD: 811, same_count: 1149242, different_count: 60
# THRESHOLD: 812, same_count: 1149242, different_count: 60
# THRESHOLD: 813, same_count: 1149242, different_count: 60
# THRESHOLD: 814, same_count: 1149242, different_count: 60
# THRESHOLD: 815, same_count: 1149242, different_count: 60
# THRESHOLD: 816, same_count: 1149242, different_count: 60
# THRESHOLD: 817, same_count: 1149242, different_count: 60
# THRESHOLD: 818, same_count: 1149242, different_count: 60
# THRESHOLD: 819, same_count: 1149242, different_count: 60
# THRESHOLD: 820, same_count: 1149242, different_count: 60
# THRESHOLD: 821, same_count: 1149242, different_count: 60
# THRESHOLD: 822, same_count: 1149242, different_count: 60
# THRESHOLD: 823, same_count: 1149242, different_count: 60
# THRESHOLD: 824, same_count: 1149242, different_count: 60
# THRESHOLD: 825, same_count: 1149242, different_count: 60
# THRESHOLD: 826, same_count: 1149242, different_count: 60
# THRESHOLD: 827, same_count: 1149242, different_count: 60
# THRESHOLD: 828, same_count: 1149242, different_count: 60
# THRESHOLD: 829, same_count: 1149242, different_count: 60
# THRESHOLD: 830, same_count: 1149242, different_count: 60
# THRESHOLD: 831, same_count: 1149242, different_count: 60
# THRESHOLD: 832, same_count: 1149243, different_count: 59
# THRESHOLD: 833, same_count: 1149243, different_count: 59
# THRESHOLD: 834, same_count: 1149243, different_count: 59
# THRESHOLD: 835, same_count: 1149243, different_count: 59
# THRESHOLD: 836, same_count: 1149243, different_count: 59
# THRESHOLD: 837, same_count: 1149243, different_count: 59
# THRESHOLD: 838, same_count: 1149243, different_count: 59
# THRESHOLD: 839, same_count: 1149243, different_count: 59
# THRESHOLD: 840, same_count: 1149243, different_count: 59
# THRESHOLD: 841, same_count: 1149243, different_count: 59
# THRESHOLD: 842, same_count: 1149243, different_count: 59
# THRESHOLD: 843, same_count: 1149243, different_count: 59
# THRESHOLD: 844, same_count: 1149243, different_count: 59
# THRESHOLD: 845, same_count: 1149243, different_count: 59
# THRESHOLD: 846, same_count: 1149243, different_count: 59
# THRESHOLD: 847, same_count: 1149243, different_count: 59
# THRESHOLD: 848, same_count: 1149243, different_count: 59
# THRESHOLD: 849, same_count: 1149243, different_count: 59
# THRESHOLD: 850, same_count: 1149243, different_count: 59
# THRESHOLD: 851, same_count: 1149243, different_count: 59
# THRESHOLD: 852, same_count: 1149243, different_count: 59
# THRESHOLD: 853, same_count: 1149243, different_count: 59
# THRESHOLD: 854, same_count: 1149244, different_count: 58
# THRESHOLD: 855, same_count: 1149244, different_count: 58
# THRESHOLD: 856, same_count: 1149244, different_count: 58
# THRESHOLD: 857, same_count: 1149244, different_count: 58
# THRESHOLD: 858, same_count: 1149244, different_count: 58
# THRESHOLD: 859, same_count: 1149244, different_count: 58
# THRESHOLD: 860, same_count: 1149245, different_count: 57
# THRESHOLD: 861, same_count: 1149246, different_count: 56
# THRESHOLD: 862, same_count: 1149247, different_count: 55
# THRESHOLD: 863, same_count: 1149247, different_count: 55
# THRESHOLD: 864, same_count: 1149247, different_count: 55
# THRESHOLD: 865, same_count: 1149247, different_count: 55
# THRESHOLD: 866, same_count: 1149247, different_count: 55
# THRESHOLD: 867, same_count: 1149247, different_count: 55
# THRESHOLD: 868, same_count: 1149247, different_count: 55
# THRESHOLD: 869, same_count: 1149248, different_count: 54
# THRESHOLD: 870, same_count: 1149248, different_count: 54
# THRESHOLD: 871, same_count: 1149248, different_count: 54
# THRESHOLD: 872, same_count: 1149248, different_count: 54
# THRESHOLD: 873, same_count: 1149248, different_count: 54
# THRESHOLD: 874, same_count: 1149248, different_count: 54
# THRESHOLD: 875, same_count: 1149248, different_count: 54
# THRESHOLD: 876, same_count: 1149248, different_count: 54
# THRESHOLD: 877, same_count: 1149248, different_count: 54
# THRESHOLD: 878, same_count: 1149248, different_count: 54
# THRESHOLD: 879, same_count: 1149248, different_count: 54
# THRESHOLD: 880, same_count: 1149248, different_count: 54
# THRESHOLD: 881, same_count: 1149248, different_count: 54
# THRESHOLD: 882, same_count: 1149248, different_count: 54
# THRESHOLD: 883, same_count: 1149248, different_count: 54
# THRESHOLD: 884, same_count: 1149248, different_count: 54
# THRESHOLD: 885, same_count: 1149248, different_count: 54
# THRESHOLD: 886, same_count: 1149248, different_count: 54
# THRESHOLD: 887, same_count: 1149248, different_count: 54
# THRESHOLD: 888, same_count: 1149248, different_count: 54
# THRESHOLD: 889, same_count: 1149248, different_count: 54
# THRESHOLD: 890, same_count: 1149248, different_count: 54
# THRESHOLD: 891, same_count: 1149248, different_count: 54
# THRESHOLD: 892, same_count: 1149248, different_count: 54
# THRESHOLD: 893, same_count: 1149249, different_count: 53
# THRESHOLD: 894, same_count: 1149249, different_count: 53
# THRESHOLD: 895, same_count: 1149249, different_count: 53
# THRESHOLD: 896, same_count: 1149249, different_count: 53
# THRESHOLD: 897, same_count: 1149249, different_count: 53
# THRESHOLD: 898, same_count: 1149249, different_count: 53
# THRESHOLD: 899, same_count: 1149249, different_count: 53
# THRESHOLD: 900, same_count: 1149249, different_count: 53
# THRESHOLD: 901, same_count: 1149249, different_count: 53
# THRESHOLD: 902, same_count: 1149249, different_count: 53
# THRESHOLD: 903, same_count: 1149249, different_count: 53
# THRESHOLD: 904, same_count: 1149250, different_count: 52
# THRESHOLD: 905, same_count: 1149250, different_count: 52
# THRESHOLD: 906, same_count: 1149250, different_count: 52
# THRESHOLD: 907, same_count: 1149250, different_count: 52
# THRESHOLD: 908, same_count: 1149250, different_count: 52
# THRESHOLD: 909, same_count: 1149250, different_count: 52
# THRESHOLD: 910, same_count: 1149250, different_count: 52
# THRESHOLD: 911, same_count: 1149250, different_count: 52
# THRESHOLD: 912, same_count: 1149251, different_count: 51
# THRESHOLD: 913, same_count: 1149251, different_count: 51
# THRESHOLD: 914, same_count: 1149251, different_count: 51
# THRESHOLD: 915, same_count: 1149251, different_count: 51
# THRESHOLD: 916, same_count: 1149251, different_count: 51
# THRESHOLD: 917, same_count: 1149251, different_count: 51
# THRESHOLD: 918, same_count: 1149251, different_count: 51
# THRESHOLD: 919, same_count: 1149251, different_count: 51
# THRESHOLD: 920, same_count: 1149251, different_count: 51
# THRESHOLD: 921, same_count: 1149251, different_count: 51
# THRESHOLD: 922, same_count: 1149254, different_count: 48
# THRESHOLD: 923, same_count: 1149254, different_count: 48
# THRESHOLD: 924, same_count: 1149254, different_count: 48
# THRESHOLD: 925, same_count: 1149254, different_count: 48
# THRESHOLD: 926, same_count: 1149254, different_count: 48
# THRESHOLD: 927, same_count: 1149254, different_count: 48
# THRESHOLD: 928, same_count: 1149254, different_count: 48
# THRESHOLD: 929, same_count: 1149254, different_count: 48
# THRESHOLD: 930, same_count: 1149255, different_count: 47
# THRESHOLD: 931, same_count: 1149255, different_count: 47
# THRESHOLD: 932, same_count: 1149255, different_count: 47
# THRESHOLD: 933, same_count: 1149255, different_count: 47
# THRESHOLD: 934, same_count: 1149255, different_count: 47
# THRESHOLD: 935, same_count: 1149255, different_count: 47
# THRESHOLD: 936, same_count: 1149255, different_count: 47
# THRESHOLD: 937, same_count: 1149255, different_count: 47
# THRESHOLD: 938, same_count: 1149255, different_count: 47
# THRESHOLD: 939, same_count: 1149256, different_count: 46
# THRESHOLD: 940, same_count: 1149257, different_count: 45
# THRESHOLD: 941, same_count: 1149257, different_count: 45
# THRESHOLD: 942, same_count: 1149257, different_count: 45
# THRESHOLD: 943, same_count: 1149257, different_count: 45
# THRESHOLD: 944, same_count: 1149257, different_count: 45
# THRESHOLD: 945, same_count: 1149257, different_count: 45
# THRESHOLD: 946, same_count: 1149257, different_count: 45
# THRESHOLD: 947, same_count: 1149257, different_count: 45
# THRESHOLD: 948, same_count: 1149258, different_count: 44
# THRESHOLD: 949, same_count: 1149258, different_count: 44
# THRESHOLD: 950, same_count: 1149258, different_count: 44
# THRESHOLD: 951, same_count: 1149258, different_count: 44
# THRESHOLD: 952, same_count: 1149258, different_count: 44
# THRESHOLD: 953, same_count: 1149258, different_count: 44
# THRESHOLD: 954, same_count: 1149258, different_count: 44
# THRESHOLD: 955, same_count: 1149258, different_count: 44
# THRESHOLD: 956, same_count: 1149258, different_count: 44
# THRESHOLD: 957, same_count: 1149258, different_count: 44
# THRESHOLD: 958, same_count: 1149258, different_count: 44
# THRESHOLD: 959, same_count: 1149258, different_count: 44
# THRESHOLD: 960, same_count: 1149258, different_count: 44
# THRESHOLD: 961, same_count: 1149258, different_count: 44
# THRESHOLD: 962, same_count: 1149258, different_count: 44
# THRESHOLD: 963, same_count: 1149258, different_count: 44
# THRESHOLD: 964, same_count: 1149258, different_count: 44
# THRESHOLD: 965, same_count: 1149258, different_count: 44
# THRESHOLD: 966, same_count: 1149258, different_count: 44
# THRESHOLD: 967, same_count: 1149258, different_count: 44
# THRESHOLD: 968, same_count: 1149258, different_count: 44
# THRESHOLD: 969, same_count: 1149258, different_count: 44
# THRESHOLD: 970, same_count: 1149258, different_count: 44
# THRESHOLD: 971, same_count: 1149258, different_count: 44
# THRESHOLD: 972, same_count: 1149258, different_count: 44
# THRESHOLD: 973, same_count: 1149258, different_count: 44
# THRESHOLD: 974, same_count: 1149258, different_count: 44
# THRESHOLD: 975, same_count: 1149258, different_count: 44
# THRESHOLD: 976, same_count: 1149259, different_count: 43
# THRESHOLD: 977, same_count: 1149260, different_count: 42
# THRESHOLD: 978, same_count: 1149260, different_count: 42
# THRESHOLD: 979, same_count: 1149260, different_count: 42
# THRESHOLD: 980, same_count: 1149260, different_count: 42
# THRESHOLD: 981, same_count: 1149260, different_count: 42
# THRESHOLD: 982, same_count: 1149260, different_count: 42
# THRESHOLD: 983, same_count: 1149260, different_count: 42
# THRESHOLD: 984, same_count: 1149260, different_count: 42
# THRESHOLD: 985, same_count: 1149261, different_count: 41
# THRESHOLD: 986, same_count: 1149261, different_count: 41
# THRESHOLD: 987, same_count: 1149261, different_count: 41
# THRESHOLD: 988, same_count: 1149261, different_count: 41
# THRESHOLD: 989, same_count: 1149261, different_count: 41
# THRESHOLD: 990, same_count: 1149261, different_count: 41
# THRESHOLD: 991, same_count: 1149261, different_count: 41
# THRESHOLD: 992, same_count: 1149261, different_count: 41
# THRESHOLD: 993, same_count: 1149261, different_count: 41
# THRESHOLD: 994, same_count: 1149262, different_count: 40
# THRESHOLD: 995, same_count: 1149262, different_count: 40
# THRESHOLD: 996, same_count: 1149262, different_count: 40
# THRESHOLD: 997, same_count: 1149262, different_count: 40
# THRESHOLD: 998, same_count: 1149262, different_count: 40
# THRESHOLD: 999, same_count: 1149262, different_count: 40
